<?xml version="1.0" encoding="UTF-8"?>
<Benchmark xmlns="http://checklists.nist.gov/xccdf/1.2"
           xmlns:h="http://www.w3.org/1999/xhtml"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           id="xccdf_io.github.bdenning_benchmark_example-20161022-1"
           xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 xccdf-1.2.xsd"
           resolved="0">

  <status date="2016-10-22">draft</status>
  
  <title>Example Fedora Linux Hardening Benchmark</title>
  <description>
    This security baseline has been developed for educational purposes.
  </description>

  <platform idref="cpe:/o:fedoraproject:fedora:24" />
  <version>20161022.1</version>
  <model system="urn:xccdf:scoring:default" />
  <model system="urn:xccdf:scoring:flat" />
  <model system="urn:xccdf:scoring:flat-unweighted" />
  
  <Profile id="xccdf_io.github.bdenning_profile_default">
    <title>Example Profile</title>
    <description>
    </description>
    <select idref="xccdf_io.github.bdenning_rule_selinux-enabled" selected="true"/>
  </Profile>

  <!-- SELinux checks -->
  <Group id="xccdf_io.github.bdenning_group_selinux">
    <title>SELinux</title>
    <description>
    </description>

    <Group id="xccdf_io.github.bdenning_group_selinux-enabled">
      <title>Enable SELinux</title>
      <description>
      </description>

      <!-- Check SELinux is not disabled in grub.conf -->
      <!-- TODO: Finish adding this check. The OVAL should be done.

      <Rule id="xccdf_io.github.bdenning_rule_selinux-enforcing" selected="true" severity="medium" weight="5">
        <title>SELinux must be enforcing</title>

        <fixtext fixref="xccdf_io.github.denning_fix_selinux-enforcing">
          setenforce 1
        </fixtext>

	<fix id="xccdf_io.github.denning_fix_selinux-enforcing"
	     system="urn:xccdf:fix:script:ansible"
	     platform="cpe:/o:fedoraproject:fedora:24" complexity="low" disruption="medium" reboot="false">
	  - name: Set SELinux to Enforcing
	    command: setenforce 1
	</fix>

	<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
	  <check-content-ref name="oval:io.github.bdenning.example:def:2" href="oval/selinux-enforcing.xml" />
	</check>
	
	</Rule>
	-->

      <!-- Check SELinux is enabled in /etc/selinux/config -->
      <Rule id="xccdf_io.github.bdenning_rule_selinux-config-enforcing" selected="true" severity="medium" weight="5">
        <title>SELinux must configured to enforce using /etc/selinux/conf</title>

        <fixtext fixref="xccdf_io.github.denning_fix_selinux-config-enforcing">
          setenforce 1
        </fixtext>

	<!-- TODO
	<fix id="xccdf_io.github.denning_fix_selinux-enabled"
	     system="urn:xccdf:fix:script:ansible"
	     platform="cpe:/o:fedoraproject:fedora:24" complexity="low" disruption="medium" reboot="true">
	     
	</fix>
	-->

	<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
	  <check-content-ref name="oval:io.github.bdenning.example:def:1" href="oval/selinux-config-enforcing.xml" />
	</check>
	
      </Rule>

      <!-- Check SELinux is enforcing -->
      <Rule id="xccdf_io.github.bdenning_rule_selinux-enforcing" selected="true" severity="medium" weight="5">
        <title>SELinux must be enforcing</title>

        <fixtext fixref="xccdf_io.github.denning_fix_selinux-enforcing">
          setenforce 1
        </fixtext>

	<fix id="xccdf_io.github.denning_fix_selinux-enforcing"
	     system="urn:xccdf:fix:script:ansible"
	     platform="cpe:/o:fedoraproject:fedora:24" complexity="low" disruption="medium" reboot="false">
	  - name: Set SELinux to Enforcing
	    command: setenforce 1
	</fix>

	<check system="http://oval.mitre.org/XMLSchema/oval-definitions-5">
	  <check-content-ref name="oval:io.github.bdenning.example:def:2" href="oval/selinux-enforcing.xml" />
	</check>
	
      </Rule>
    </Group>

  </Group>
</Benchmark>
