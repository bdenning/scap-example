<?xml version="1.0" encoding="utf-8"?>
<oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5"
		  xmlns:lin-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux"
		  xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5"
		  xmlns:ind-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent"
		  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <generator>
    <oval:product_name>emacs</oval:product_name>
    <oval:schema_version>5.10.1</oval:schema_version>
    <oval:timestamp>2016-10-23T11:30:00+10:00</oval:timestamp>
  </generator>

  <definitions>
    <definition  class="compliance" id="oval:io.github.bdenning.example:def:3" version="1">
      <metadata>
	<title>Enable SELinux within /etc/grub.conf</title>
	<affected family="unix">
          <platform>Fedora 24</platform>
	</affected>
	<description>Check if selinux=0 OR enforcing=0 within /etc/grub.conf lines, fail if found..</description>
      </metadata>
      <criteria>
	<criterion comment="heck value selinux|enforcing=0 in /etc/grub.conf" test_ref="oval:io.github.bdenning.example:tst:3" />
      </criteria>
    </definition>
  </definitions>

  <tests>
    <ind-def:textfilecontent54_test check="all" check_existence="none_exist" comment="check value selinux|enforcing=0 in /etc/grub.conf"
				    id="oval:io.github.bdenning.example:tst:3" version="1">
      <ind-def:object object_ref="oval:io.github.bdenning.example:obj:3" />
    </ind-def:textfilecontent54_test>
  </tests>

  <objects>
    <ind-def:textfilecontent54_object id="oval:io.github.bdenning.example:obj:3" version="1">
      <ind-def:filepath>/etc/grub.conf</ind-def:filepath>
      <ind-def:pattern operation="pattern match">^[\s]*kernel[\s]+.*(selinux|enforcing)=0.*$</ind-def:pattern>
      <ind-def:instance datatype="int" operation="equals">1</ind-def:instance>
    </ind-def:textfilecontent54_object>
  </objects>

</oval_definitions>
